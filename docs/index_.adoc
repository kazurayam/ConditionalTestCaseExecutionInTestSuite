= Conditional Test Case Execution in Test Suite in Katalon Studio

== Problem to solve

In the following repository, you can find a set of codes for explanation.

* link:https://github.com/kazurayam/ConditionalTestCaseExecutionInTestSuite-demo[ConditionalTestCaseExecutionInTestSuite-demo]

In this repository, I have a Katalon Studio project with a Test Suite named `TSa`. The `TSa` consists of 4 Test Cases: `TCa1`, `TCa2`, `TCa3` and `TCa4`. The `TSa` will invoke 4 Test Cases just sequentially. The `TCa1`, `TCa2` and `TCa4` --- these run quickly in a few seconds; but the `TCa3` could run long (20 secs, 2 minutes, 20 minutes, 2 hours ...).

Regardless accidentally or intentionally, the `TCa2` could fail. Even if the `TCa2` failed, the Test Suite `TSa` will continue invoking the following Test cases `TCa3` and `TCa4`. See the following screenshot.

image::./images/1_TSa.png[]

Now I introduce a condition:

[quote]
____
When the `TCa2` failed, I do not like to wait for the long-running `TCa3` to finish, because (due to some sensible reasons) the `TCa3` is not worth executing if its preceding `TCa2` failed. Rather I want the Test Suite to stop so that I can start debugging the `TCa2` as soon as possible.
____

In the Katalon Studio GUI, I would be watching it and would notice any failures during a Test Suite run. Then I would able stop the Test Suite by some manual intervention (clicking a "stop" button). But in the Katalon Runtime Engine, we have very little chance to intervene the progress of a Test Suite run. When the `TCa2` failed, still the `TCa3` will be invoked. We are supposed to wait for the `TCa3` to finish. We have no other option. This is the problem.

== Proposed Solution

This project provides a jar file which contains a Groovy class named

* link:https://github.com/kazurayam/ConditionalTestCaseExecutionInTestSuite/blob/develop/Keywords/com/kazurayam/ks/TestCaseResults.groovy[`com.kazurayam.ks.TestCaseResults`]

which is supposed to be used in a link:https://katalon.com/katalon-studio[Katalon Studio] project. Here is a sample Test Case script that utilizes it:

[source,groovy]
----
include::../Scripts/conditional-withFailure/TCb3/Script1681386955295.groovy[]
----

This is a Test Case named `TCb3`. The `TCb3` is bundled in a Test Suite named `TSb` which consists of 4 Test Cases: `TCb1`, `TCb2`, `TCb3` and `TCb4`. These 4 Test Cases will be executed just sequentially.

Look at the souce code; the `TCb3` is calling `TestCaseResults.assertTestCasePASSED("conditional-withFailure/TCb2")`. With this statement, the `TCb3` can make an assertion if the preceding Test Case  `"conditional-withFailure/TCb2"` had its status `PASSED` or not. If the `TCb2` is found `PASSED`, the call to `assertTestCasePassed` will silently return. Then the `TCb3` will continue its processing. If the `TCb2` is found to have the status not `PASSED`, the call to `assertTestCasePASSED()` will raise a `StepFailedException`. Effectively the Test Case `TCb3` will skip its processing body.

The `TestCaseResults.assertTestCasePASSED(String testCaseId)` enables you to conditionally execute your Test Case depending on the result of preceding Test Case in a Test Suite. **In each Test Case scripts, you can optionally call `TestCaseResult.assertTestCasePASSED(precedingTestCaseId)` to determine if it should quit soon or continue its long running test processing.**

== Solution Explained

=== Installing the jar file

A jar file that contains `com.kazurayam.ks.TestCaseResult` class is downloadable at the link:https://github.com/kazurayam/ConditionalTestCaseExecutionInTestSuite/releases/[Releases page]. You want to create your own Katalon Studio project. Download the jar into the `Drivers` folder in the project.

=== Create a Test Listener

You have to create a List Listener code. The name of Test Listener can be any; for example `TL1`. The code should be like this:

[source]
----
include::../Test Listeners/TL1.groovy[]
----

You do not need to customize it. Just copy & paste this sample.

This code transfers the result of all Test Cases in a Test Suite to the instance of `com.kazurayam.ks.TestCaseResults` class. This code is mandatory to let the `TestCaseResults` instance be able to serve the `assertTestCasePASSED(String testCaseId)` method.



=== Sample codes explained

== Test Suites/TSa

image::./diagrams/out/activity-unconditional/TSa.png[]

== Test Suites/TSb

image::./diagrams/out/activity-conditional-withFailure/TSb.png[]

== Test Suites/TCs

image::./diagrams/out/activity-conditional-noFailure/TSc.png[]
