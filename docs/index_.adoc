= Conditional Test Case Execution in Test Suite in Katalon Studio

== Problem to solve

I have a Katalon Studio project with a Test Suite named `TSb`. The `TSb` consists of 4 Test Cases: `TCb1`, `TCb2`, `TCb3` and `TCb4`. The `TCb1`, 'TCb2' and `TCb4` --- these Test Cases run quickly (in a few seconds) but the `TCb3` run fairly long (20 secs, 2 minutes, 20 minutes, ...).

Regardless accidentally or intentionally, the `TCb2` could fail. Even if the `TCb2` failed, the following Test cases (`TCb3` and `TCb4`) will be invoked by Test suite. As mentioned, the `TCb3` could take long time to run. See the following screenshot.

image::./images/1_TSa.png[]

Now I introduce a condition:

[quote]
____
When the `TCb2` failed, I do not like to wait for the long-running `TCb3` to finish.
____

If I am using Katalon Studio GUI, I would be able to click some button to cancel the Test Suite and stop every thing. But in Katalon Runtime Engine, it is not easy to detect if any of Test Case failed and therefore to cancel the Test Suite. I want a solution that fully automate a conditional Test Cases execution in Test Suite. I want to stop a failing Test Suite as soon as possible. I want to fully customize the condition. How can I achieve it?

== Proposed Solution

This project provides a jar file which contains a Groovy class named

* link:https://github.com/kazurayam/ConditionalTestCaseExecutionInTestSuite/blob/develop/Keywords/com/kazurayam/ks/TestCaseResults.groovy[`com.kazurayam.ks.TestCaseResults`]

which is supposed to be used in a link:https://katalon.com/katalon-studio[Katalon Studio] project. Here is a sample Test Case script that utilizes it:

[source,groovy]
----
include::../Scripts/conditional-withFailure/TCb3/Script1681386955295.groovy[]
----

This is a Test Case named `TCb3`. The `TCb3` is bundled in a Test Suite named `TSb` which consists of 4 Test Cases: `TCb1`, `TCb2`, `TCb3` and `TCb4`. These 4 Test Cases will be executed just sequentially.

Look at the souce code; the `TCb3` is calling `TestCaseResults.assertTestCasePASSED("conditional-withFailure/TCb2")`. With this statement, the `TCb3` can make an assertion if the preceding Test Case  `"conditional-withFailure/TCb2"` had its status `PASSED` or not. If the `TCb2` is found `PASSED`, the call to `assertTestCasePassed` will silently return. Then the `TCb3` will continue its processing. If the `TCb2` is found to have the status not `PASSED`, the call to `assertTestCasePASSED()` will raise a `StepFailedException`. Effectively the Test Case `TCb3` will skip its processing body.

The `TestCaseResults.assertTestCasePASSED(String testCaseId)` enables you to conditionally execute your Test Case depending on the result of preceding Test Case in a Test Suite. **In each Test Case scripts, you can optionally call `TestCaseResult.assertTestCasePASSED(precedingTestCaseId)` to determine if it should quit soon or continue its long running test processing.**

== Solution Explained

=== Installing the jar file

A jar file that contains `com.kazurayam.ks.TestCaseResult` class is downloadable at the link:https://github.com/kazurayam/ConditionalTestCaseExecutionInTestSuite/releases/[Releases page]. You want to create your own Katalon Studio project. Download the jar into the `Drivers` folder in the project.

=== Create a Test Listener

You want to create a List Listener code. The name of Test Listener can be any; for example `TL1`. The code should be like this:

[source]
----
include::../Test Listeners/TL1.groovy[]
----

Perhaps you do not need to customize it. Just copy & paste this sample.

=== Sample project

In the following repository, you can find a set of sample codes that uses the proposed solution.

* link:https://github.com/kazurayam/ConditionalTestCaseExecutionInTestSuite-demo[ConditionalTestCaseExecutionInTestSuite-demo]

=== Sample codes explained

== Test Suites/TSa

image::./diagrams/out/activity-unconditional/TSa.png[]

== Test Suites/TSb

image::./diagrams/out/activity-conditional-withFailure/TSb.png[]

== Test Suites/TCs

image::./diagrams/out/activity-conditional-noFailure/TSc.png[]
